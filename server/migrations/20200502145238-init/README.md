# Migration `20200502145238-init`

This migration has been generated by maticzav at 5/2/2020, 2:52:38 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TYPE "BillingPeriod" AS ENUM ('ANNUALLY', 'MONTHLY');

CREATE TYPE "InstallationType" AS ENUM ('ORGANIZATION', 'USER');

CREATE TABLE "public"."Purchase" (
"billingPeriod" "BillingPeriod" NOT NULL ,"company" text   ,"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"email" text  NOT NULL ,"ghAccount" text  NOT NULL ,"id" text  NOT NULL ,"name" text  NOT NULL ,"plan" text  NOT NULL ,"planId" integer  NOT NULL ,"type" "InstallationType" NOT NULL ,"updatedAt" timestamp(3)  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."Bill" (
"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"id" text  NOT NULL ,"purchaseId" text  NOT NULL ,"updatedAt" timestamp(3)  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."StripeBill" (
"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"id" text  NOT NULL ,"updatedAt" timestamp(3)  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE UNIQUE INDEX "Purchase.ghAccount" ON "public"."Purchase"("ghAccount")

ALTER TABLE "public"."Bill" ADD FOREIGN KEY ("purchaseId")REFERENCES "public"."Purchase"("id") ON DELETE CASCADE  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200502145238-init
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,51 @@
+datasource postgresql {
+  provider = "postgresql"
+  url      = env("POSTGRESQL_URL")
+}
+
+generator client {
+  provider = "prisma-client-js"
+}
+
+model Purchase {
+  id            String           @default(cuid()) @id
+  createdAt     DateTime         @default(now())
+  updatedAt     DateTime         @updatedAt
+  // Installation Info
+  ghAccount     String           @unique
+  name          String
+  company       String?
+  email         String
+  type          InstallationType
+  // Purchase
+  planId        Int
+  plan          String
+  billingPeriod BillingPeriod
+  // Billing
+  bills         Bill[]
+}
+
+model Bill {
+  id         String   @default(cuid()) @id
+  createdAt  DateTime @default(now())
+  updatedAt  DateTime @updatedAt
+  // Purchase
+  purchase   Purchase @relation(fields: [purchaseId], references: [id])
+  purchaseId String
+}
+
+enum BillingPeriod {
+  ANNUALLY
+  MONTHLY
+}
+
+enum InstallationType {
+  ORGANIZATION
+  USER
+}
+
+model StripeBill {
+  id        String   @default(cuid()) @id
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+}
```
